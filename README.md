# Abbreviated Smell Test to Identify Patients with PD/DLB

Code for analysis in the manuscript entitled "Development of a Simplified Smell Test to Identify Patients with Typical Parkinson’s as Informed by Multiple Cohorts, Machine Learning and External Validation". 

medRxiv preprint doi: https://doi.org/10.1101/2024.08.09.24311696

## Data files

Datasets of the three cohorts used in this study can be accessed via zenodo (link to be updated) upon request.

1. `Data dictionary.xlsx`
2. `Ottawa_cut.csv`: Ottawa (PREDIGT) Trial (baseline)
3. `PROBE_cut.csv`: Prognostic Biomarkers in Parkinson’s Disease Study (PROBE; baseline)
4. `DeNoPa_cut.csv`: “_De Novo_ Parkinson disease study” (DeNoPa; baseline, 48-month, and 72-month follow-up visits)

## Supportive files

Included in this repo:

1. `diagnosis colors.csv`: colors representing each diagnostic groups for plotting.
2. `Published rankings.csv`: 8 previously published scent rankings, 4 for SST-ID, 4 for UPSIT.
3. `scent_shared.csv`: 11 scents that are shared by SST-ID and UPSIT. (__Note:__ this file is generated by `4. Combine UPSIT and SST-ID.qmd`, but is also required by `1. Tables, distributions, ROCs.qmd` for plotting. So I included it here to avoid running error.)
4. `SST_ID_option.csv`: Options provided for each SST-ID scent, used for generating ICCs.
5. `UPSIT_key.csv`: answer keys of UPSIT.
6. `UPSIT_option.csv`: Options provided for each UPSIT scent, used for generating ICCs.

## Code files

1. `1. Tables, distributions, ROCs.qmd`
   1. Code for
      - Table 1:
      - Table 2:
      - Supplemental Table 2:
      - Figure 2:
      - Supplemental Figure 1:
   2. Need to read
      - `diagnosis colors.csv`
      - `Ottawa_cut.csv`
      - `PROBE_cut.csv`
      - `DeNoPa_cut.csv`
2. `2. Abbreviated Smell Test SST-ID.qmd`
3. `3. Abbreviated Smell Test UPSIT.qmd`
4. `4. Combine UPSIT and SST-ID.qmd`

## Supportive function

Supportive functions are placed in the `R` folder. These functions need to be sourced in `2. Abbreviated Smell Test SST-ID.qmd` and `4. Combine UPSIT and SST-ID.qmd`.

1. `itemAUC.R`: calculate each scent's AUC values and rank them, using cross-validation
2. `subsetAUC.R`: calculate each subset's AUC values.
3. Modified `TestGardener` functions to generate ICCs: `make.dataList.R`, `Wbinsmth.R`, `eval_surp.R`, `ICC.plot.R`

